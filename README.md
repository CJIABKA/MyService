# Краткое описание

Сервис по консолидации данных из разных источников.

**Конфигурация переменных окружения**

- SECRET_KEY - ключ для хеширующей функции
- SQLALCHEMY_DATABASE_URI - строка для подключения к БД (подробнее ниже)
- SQLALCHEMY_TRACK_MODIFICATIONS - (False) возможность сигнализирования о необходимости внесения изменений
- MAIL_SERVER - почтовый сервер
- MAIL_PORT - порт
- MAIL_USE_TLS - флаг включения зашифрованных соединений
- MAIL_USERNAME - логин от почтового аккаунта
- MAIL_PASSWORD - пароль от почтового аккаунта
- ADMINS - массив адрессов, на который будут слаться письма с отчётами об ошибках

**Инициализация базы данных (только для новой БД)**

1. Передать в переменную окружения "SQLALCHEMY_DATABASE_URI" строку подключения к БД в формате
dialect+driver://username:password@host:port/database
(в зависимости БД могут быть различия, подробнее https://docs.sqlalchemy.org/en/13/core/engines.html) 

2. в терминале ввести команду flask db init 

**Миграция БД/обновление после измеений в моделях**

в терминале:
1.  flask db migrate -m "комментарий"

2.  flask upgrade

**Описания моделей:**

- User - пользователи
- Stations - АЗС
- Photos - фотографии
- Services - дополнительные услуги
- Goods - виды топлива
- services_on_stations - таблица для организации отношений многие ко многим между Stations и Services

**Установка задач по времени**

в терминале:
- flask crontab add - добавить задачи (в список попадут процедуры задекорирванные @crontab.job)
- flask crontab remove - удалить задачи
- flask crontab show - показать текущие задачи

**Запросы (формат по умолчанию JSON):**

Получить всю информацию сразу
- `GET localhost:5000/api/data`
- `GET localhost:5000/api/data/0`

Получить по 100 элементов за раз
- `GET localhost:5000/api/data/:int`

Ошибки записываются в лог-файлы `'logs/gss_service.log'`




